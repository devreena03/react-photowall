(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{183:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"startAddingPost",function(){return T}),n.d(a,"startLoadingPost",function(){return _}),n.d(a,"startRemovePost",function(){return I}),n.d(a,"loadPosts",function(){return L}),n.d(a,"removePost",function(){return R}),n.d(a,"addPhoto",function(){return H}),n.d(a,"addComment",function(){return J});var o=n(0),r=n.n(o),c=n(85),i=n.n(c),s=(n(96),n(188)),u=n(17),l=n(33),m=n(26),d=n(66),p=[];var f=Object(u.c)({comments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COMMENT":return e[t.postId]?Object(d.a)({},e,Object(m.a)({},t.postId,[].concat(Object(l.a)(e[t.postId]),[t.comment]))):Object(d.a)({},e,Object(m.a)({},t.postId,[t.comment]));default:return e}},posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(console.log("post reducer"),t.type){case"REMOVE_POST":return[].concat(Object(l.a)(e.slice(0,t.index)),Object(l.a)(e.slice(t.index+1)));case"ADD_POST":return[].concat(Object(l.a)(e),[t.post]);case"LOAD_POSTS":return t.posts;default:return e}}}),h=n(49),b=n(20),v=n(21),O=n(23),E=n(22),j=n(24);var g=function(){return r.a.createElement("h1",null,"Photowall")},y=n(185);var P=function(e){var t=e.post;return r.a.createElement("figure",{className:"figure"},r.a.createElement(y.a,{to:"single/".concat(t.id)},r.a.createElement("img",{className:"photo",src:t.imageLink,alt:t.description})),r.a.createElement("figcaption",null,r.a.createElement("p",null,t.description)),r.a.createElement("div",{className:"button-container"},r.a.createElement("button",{onClick:function(){e.startRemovePost(e.index,t.id),e.history.push("/")}}," Remove "),r.a.createElement(y.a,{className:"button",to:"single/".concat(t.id)},r.a.createElement("div",{className:"comment-count"},r.a.createElement("div",{className:"speech-bubble"}),e.comments[t.id]?e.comments[t.id].length:0))))};var k=function(e){return r.a.createElement("div",null,r.a.createElement(y.a,{className:"add-icon",to:"/add-photo"}),r.a.createElement("div",{className:"photo-grid"},e.posts.sort(function(e,t){return t.id-e.id}).map(function(t,n){return r.a.createElement(P,Object.assign({key:n,post:t},e,{index:n}))})))},D=n(13),N=function(e){function t(){var e;return Object(b.a)(this,t),(e=Object(O.a)(this,Object(E.a)(t).call(this))).addPhoto=e.addPhoto.bind(Object(D.a)(Object(D.a)(e))),e}return Object(j.a)(t,e),Object(v.a)(t,[{key:"addPhoto",value:function(e){e.preventDefault(),console.log(e.target.elements.link.value),console.log(e.target.elements.description.value);var t={id:Number(new Date),description:e.target.elements.description.value,imageLink:e.target.elements.link.value};this.props.startAddingPost(t),this.props.onHistory.push("/")}},{key:"render",value:function(){return r.a.createElement("div",{className:"form"},r.a.createElement("form",{onSubmit:this.addPhoto},r.a.createElement("input",{type:"text",placeholder:"Link",name:"link"}),r.a.createElement("input",{type:"text",placeholder:"Description",name:"description"}),r.a.createElement("button",null,"Post")))}}]),t}(o.Component),S=n(186),x=function(e){function t(){var e;return Object(b.a)(this,t),(e=Object(O.a)(this,Object(E.a)(t).call(this))).handleSubmit=e.handleSubmit.bind(Object(D.a)(Object(D.a)(e))),e}return Object(j.a)(t,e),Object(v.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=e.target.elements.comment.value;this.props.addComment(t,this.props.id),e.target.elements.comment.value=""}},{key:"render",value:function(){return console.log(this.props.comments),r.a.createElement("div",{className:"comment"},this.props.comments.map(function(e,t){return r.a.createElement("p",{key:t}," ",e," ")}),r.a.createElement("form",{className:"comment-form",onSubmit:this.handleSubmit},r.a.createElement("input",{type:"text",placeholder:"comment",name:"comment"}),r.a.createElement("input",{type:"submit",hidden:!0})))}}]),t}(o.Component),C=function(e){function t(){return Object(b.a)(this,t),Object(O.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props,t=e.match,n=e.posts,a=Number(t.params.id),o=n.find(function(e){return e.id===a}),c=this.props.comments[a]||[],i=this.props.posts.findIndex(function(e){return e.id===a});return console.log(o),r.a.createElement("div",{className:"single-photo"},r.a.createElement(P,Object.assign({post:o},this.props,{index:i})),r.a.createElement(x,{addComment:this.props.addComment,comments:c,id:a}))}}]),t}(o.Component),w=function(e){function t(){return Object(b.a)(this,t),Object(O.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){console.log("componentDidMount"),this.props.startLoadingPost()}},{key:"render",value:function(){var e=this;return console.log(this.props),r.a.createElement("div",null,r.a.createElement("h1",null,r.a.createElement(y.a,{to:"/"},r.a.createElement(g,null))),r.a.createElement(S.a,{exact:!0,path:"/",render:function(){return r.a.createElement("div",null,r.a.createElement(k,e.props))}}),r.a.createElement(S.a,{path:"/add-photo",render:function(t){var n=t.history;return r.a.createElement("div",null,r.a.createElement(N,Object.assign({},e.props,{onHistory:n})))}}),r.a.createElement(S.a,{path:"/single/:id",render:function(t){return r.a.createElement("div",null,r.a.createElement(C,Object.assign({},e.props,t)))}}))}}]),t}(o.Component),A=n(69);A.initializeApp({});var M=A.database();function T(e){return function(t){return M.ref("posts").update(Object(m.a)({},e.id,e)).then(function(){t(H(e))})}}function _(){return function(e){return M.ref("posts").once("value").then(function(t){var n=[];t.forEach(function(e){n.push(e.val())}),e(L(n))})}}function I(e,t){return function(n){return M.ref("posts/".concat(t)).remove().then(function(){n(R(e))})}}function L(e){return{type:"LOAD_POSTS",posts:e}}function R(e){return{type:"REMOVE_POST",index:e}}function H(e){return{type:"ADD_POST",post:e}}function J(e,t){return{type:"ADD_COMMENT",comment:e,postId:t}}var V=n(187);var z=Object(V.a)(Object(h.b)(function(e){return{posts:e.posts,comments:e.comments}},function(e){return Object(u.b)(a,e)})(w)),B=n(90),q=Object(u.d)(f,Object(u.a)(B.a));i.a.render(r.a.createElement(h.a,{store:q},r.a.createElement(s.a,null,r.a.createElement(z,null))),document.getElementById("root"))},91:function(e,t,n){e.exports=n(183)},96:function(e,t,n){}},[[91,1,2]]]);
//# sourceMappingURL=main.4d2603f7.chunk.js.map